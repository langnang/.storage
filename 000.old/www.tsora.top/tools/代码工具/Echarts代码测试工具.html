<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Testing Bootstrap</title>
	<link rel="icon" href="/resources/src/img/icon/tsora.png">
	<script type="text/javascript" src="/resources/vendor/require/2.3.5/require.min.js"></script>
	<script type="text/javascript" src="/resources/src/js/require-config.js"></script>
</head>
<body>
	<div class="container-fluid">
		<div class="row">
			<div class="col-md-5">
				<button class="btn btn-success btn-xs" style="position: absolute;z-index: 100;right:0;" onclick="run()">运行</button>
				<div id="editor" style="height: calc(100vh - 115px);"></div>
				<ul class="list-inline list-group" style="margin-bottom: 0px;">
					<li class="list-group-item">Bootstrap<span class="label label-primary">3.3.7</span></li>
					<li class="list-group-item">JQuery<span class="label label-primary">3.3.1</span></li>
					<li class="list-group-item">Echarts<span class="label label-primary">3.8.5</span></li>
					<li class="list-group-item">Ace<span class="label label-primary">1.3.3</span></li>
				</ul>
			</div>
			<div class="col-md-7" id="echarts" style="height: calc(100vh - 70px);">
			</div>
		</div>
	</div>

	<script type="text/javascript">
		require(["initialize","bootstrap","echarts","ace"],function(ini,bootstrap,echarts,ace){
			var editor = ace.edit("editor",{
				theme:'ace/theme/chrome',
				mode:'ace/mode/javascript',
				foldStyle:'markbeginend'
			});
			var dir = getUrlParms("dir");
			var file = getUrlParms("file");
			if(dir==null||file==null){
				dir="Line";
				file="Basic Line Chart.js";
			}
			document.title = file.substring(0,file.lastIndexOf(".js"));
			$.ajax({
				type:"get",
				url:"/resources/data/echarts/"+dir+"/"+file,
				success:function(data){
				// console.log(data);
				editor.setValue(data,1);
				run();
			}
		})



			var myChart = echarts.init(document.getElementById('echarts'));

			function run(){
				var text=editor.getValue();
				eval(text);
				myChart.setOption(option);
			}

			$('#editor').on("keyup",function(){
				run();
			})
			function getUrlParms(name){
				var reg = new RegExp("(^|&)"+ name +"=([^&]*)(&|$)");
				var r = window.location.search.substr(1).match(reg);
				if(r!=null)
					return unescape(r[2]);
				return null;
			}
		})
		

	</script>
</body>
</html>